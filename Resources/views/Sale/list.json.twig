{% trans_default_domain "dzangocart" %}

{% spaceless %}
{
    "draw": {{ app.request.query.all.draw }},
    "recordsTotal": {{ meta.total_count }},
    "recordsFiltered": {{ meta.filtered_count }},
    "data" : [
        {% for sale in results %}
            {
                "DT_RowId": "{{ 'u_' ~ sale.id }}",
                "DT_RowClass": "{{ sale.isTest ? 'test' : '' }}{% if not sale.paid %} unpaid{% endif %}",
                "id": {{ sale.id() }},
                "date": "{{ sale.date|datetime(dzangocart_config.date_format, dzangocart_config.time_format) }}",
                "order_id": "{{ sale.orderId }}",
				"customer":    {
					"id": 		"{{ sale.customer.id }}",
					"name":     "{{ sale.customer.name }}",
					"code": 	"{{ sale.customer.code }}"
				},
                "item": "{{ sale.name|raw }}",
                "quantity": "{{ sale.quantity|integer }}",
                "currency": "{{ sale.currency }}",
                "amount_excl": "{{ sale.amountExcl|currency(sale.currency, app.request.locale) }}",
                "tax_amount": "{{ sale.amountTax|currency(sale.currency, app.request.locale) }}",
                "amount_incl": "{{ sale.amountIncl|currency(sale.currency, app.request.locale) }}",
                "paid": "{{ sale.paid }}",
                "affiliate": "{{ sale.affiliate }}",
				"test":        {{ sale.isTest ? 1 : 0 }},
				"urls": {
					"order": "{{ path('dzangocart_order', { id: sale.getOrderId }) }}"
				}
            }{% if not loop.last %},{% endif %}
        {% endfor %}
    ]
}
{% endspaceless %}
